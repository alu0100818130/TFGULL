{"version":3,"sources":["webpack:///./src/main/js/app/components/extensions/OrganizationPageExtension.js","webpack:///./src/main/js/api/user_groups.ts","webpack:///./src/main/js/apps/organizations/actions.js","webpack:///./src/main/js/app/components/extensions/utils.js","webpack:///./src/main/js/app/components/extensions/Extension.js","webpack:///./src/main/js/app/components/extensions/ExtensionContainer.tsx","webpack:///./src/main/js/app/components/extensions/ExtensionNotFound.tsx"],"names":["OrganizationPageExtension","_super","_this","apply","this","arguments","refreshOrganization","props","fetchOrganization","organization","key","__extends","prototype","render","_a","params","extensionKey","pluginKey","pages","canAdmin","adminPages","concat","extension","find","p","react__WEBPACK_IMPORTED_MODULE_0___default","a","createElement","_ExtensionContainer__WEBPACK_IMPORTED_MODULE_2__","location","options","_ExtensionNotFound__WEBPACK_IMPORTED_MODULE_3__","PureComponent","mapDispatchToProps","_apps_organizations_actions__WEBPACK_IMPORTED_MODULE_5__","__webpack_exports__","Object","react_redux__WEBPACK_IMPORTED_MODULE_1__","state","ownProps","_store_rootReducer__WEBPACK_IMPORTED_MODULE_4__","organizationKey","searchUsersGroups","data","_helpers_request__WEBPACK_IMPORTED_MODULE_0__","catch","_app_utils_throwGlobalError__WEBPACK_IMPORTED_MODULE_1__","getUsersInGroup","addUserToGroup","removeUserFromGroup","createGroup","then","r","group","updateGroup","deleteGroup","dispatch","Promise","all","_api_organizations__WEBPACK_IMPORTED_MODULE_0__","navigation","organizationWithPermissions","__assign","_store_organizations_duck__WEBPACK_IMPORTED_MODULE_1__","_store_rootActions__WEBPACK_IMPORTED_MODULE_5__","fetchOrganizationGroups","_api_user_groups__WEBPACK_IMPORTED_MODULE_3__","response","groups","createOrganization","fields","_store_globalMessages_duck__WEBPACK_IMPORTED_MODULE_7__","_helpers_l10n__WEBPACK_IMPORTED_MODULE_8__","name","error","reject","onRejected","updateOrganization","changes","deleteOrganization","fetchMembers","receiveAction","query","page","_store_organizationsMembers_actions__WEBPACK_IMPORTED_MODULE_2__","loading","ps","q","users","total","paging","pageIndex","onMembersFail","fetchOrganizationMembers","fetchMoreOrganizationMembers","getState","_store_rootReducer__WEBPACK_IMPORTED_MODULE_6__","addOrganizationMember","member","login","user","removeOrganizationMember","updateOrganizationMemberGroups","add","remove","_store_users_actions__WEBPACK_IMPORTED_MODULE_4__","groupCount","length","promises","map","getExtensionStart","resolve","fromCache","installExtensionsHandler","scriptTag","document","src","window","baseUrl","onload","getElementsByTagName","appendChild","installScript","start","Extension_Extension","Extension","handleStart","store","getStore","stop","el","container","currentUser","intl","router","handleFailure","onFail","l10n","componentDidMount","startExtension","componentDidUpdate","prevProps","stopExtension","hash","componentWillUnmount","index_js_exposed_default","Helmet_default","title","ref","extensions_Extension","index_es","react_router_es","es","rootReducer","ExtensionNotFound","react__WEBPACK_IMPORTED_MODULE_0__","id","className","react_router__WEBPACK_IMPORTED_MODULE_1__","to"],"mappings":"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","file":"js/285.8d0face4.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport ExtensionContainer from './ExtensionContainer';\nimport ExtensionNotFound from './ExtensionNotFound';\nimport { getOrganizationByKey } from '../../../store/rootReducer';\nimport { fetchOrganization } from '../../../apps/organizations/actions';\n/*:: import type { Organization } from '../../../store/organizations/duck'; */\n\n/*::\ntype Props = {\n  fetchOrganization: string => void,\n  location: {},\n  organization: Organization,\n  params: {\n    extensionKey: string,\n    organizationKey: string,\n    pluginKey: string\n  }\n};\n*/\n\nclass OrganizationPageExtension extends React.PureComponent {\n  /*:: props: Props; */\n\n  refreshOrganization = () => this.props.fetchOrganization(this.props.organization.key);\n\n  render() {\n    const { extensionKey, pluginKey } = this.props.params;\n    const { organization } = this.props;\n\n    let pages = organization.pages || [];\n    if (organization.canAdmin && organization.adminPages) {\n      pages = pages.concat(organization.adminPages);\n    }\n\n    const extension = pages.find(p => p.key === `${pluginKey}/${extensionKey}`);\n    return extension ? (\n      <ExtensionContainer\n        extension={extension}\n        location={this.props.location}\n        options={{ organization, refreshOrganization: this.refreshOrganization }}\n      />\n    ) : (\n      <ExtensionNotFound />\n    );\n  }\n}\n\nconst mapStateToProps = (state, ownProps /*: Props */) => ({\n  organization: getOrganizationByKey(state, ownProps.params.organizationKey)\n});\n\nconst mapDispatchToProps = { fetchOrganization };\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrganizationPageExtension);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON, post, postJSON } from '../helpers/request';\nimport { Paging, Group } from '../app/types';\nimport throwGlobalError from '../app/utils/throwGlobalError';\n\nexport function searchUsersGroups(data: {\n  f?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n  q?: string;\n}): Promise<{ groups: Group[]; paging: Paging }> {\n  return getJSON('/api/user_groups/search', data).catch(throwGlobalError);\n}\n\nexport interface GroupUser {\n  login: string;\n  name: string;\n  selected: boolean;\n}\n\nexport function getUsersInGroup(data: {\n  id?: number;\n  name?: string;\n  organization?: string;\n  p?: number;\n  ps?: number;\n  q?: string;\n  selected?: string;\n}): Promise<{ paging: Paging; users: GroupUser[] }> {\n  return getJSON('/api/user_groups/users', data).catch(throwGlobalError);\n}\n\nexport function addUserToGroup(data: {\n  id?: string;\n  name?: string;\n  login?: string;\n  organization?: string;\n}) {\n  return post('/api/user_groups/add_user', data).catch(throwGlobalError);\n}\n\nexport function removeUserFromGroup(data: {\n  id?: string;\n  name?: string;\n  login?: string;\n  organization?: string;\n}) {\n  return post('/api/user_groups/remove_user', data).catch(throwGlobalError);\n}\n\nexport function createGroup(data: {\n  description?: string;\n  organization: string | undefined;\n  name: string;\n}): Promise<Group> {\n  return postJSON('/api/user_groups/create', data).then(r => r.group, throwGlobalError);\n}\n\nexport function updateGroup(data: { description?: string; id: number; name?: string }) {\n  return post('/api/user_groups/update', data).catch(throwGlobalError);\n}\n\nexport function deleteGroup(data: { name: string; organization: string | undefined }) {\n  return post('/api/user_groups/delete', data).catch(throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport * as api from '../../api/organizations';\nimport * as actions from '../../store/organizations/duck';\nimport * as membersActions from '../../store/organizationsMembers/actions';\nimport { searchUsersGroups, addUserToGroup, removeUserFromGroup } from '../../api/user_groups';\nimport { receiveUser } from '../../store/users/actions';\nimport { onFail } from '../../store/rootActions';\nimport { getOrganizationMembersState } from '../../store/rootReducer';\nimport { addGlobalSuccessMessage } from '../../store/globalMessages/duck';\nimport { translate, translateWithParameters } from '../../helpers/l10n';\n/*:: import type { Organization } from '../../store/organizations/duck'; */\n/*:: import type { Member } from '../../store/organizationsMembers/actions'; */\n\nconst PAGE_SIZE = 50;\n\nconst onRejected = (dispatch /*: Function */) => (error /*: Object */) => {\n  onFail(dispatch)(error);\n  return Promise.reject();\n};\n\nconst onMembersFail = (organization /*: string */, dispatch /*: Function */) => (\n  error /*: Object */\n) => {\n  onFail(dispatch)(error);\n  dispatch(membersActions.updateState(organization, { loading: false }));\n};\n\nexport const fetchOrganization = (key /*: string */) => (dispatch /*: Function */) => {\n  const onFulfilled = ([organization, navigation]) => {\n    if (organization) {\n      const organizationWithPermissions = { ...organization, ...navigation };\n      dispatch(actions.receiveOrganizations([organizationWithPermissions]));\n    }\n  };\n\n  return Promise.all([api.getOrganization(key), api.getOrganizationNavigation(key)]).then(\n    onFulfilled,\n    onFail(dispatch)\n  );\n};\n\nexport const fetchOrganizationGroups = (organization /*: string */) => (\n  dispatch /*: Function */\n) => {\n  return searchUsersGroups({ organization }).then(response => {\n    dispatch(actions.receiveOrganizationGroups(organization, response.groups));\n  }, onFail(dispatch));\n};\n\nexport const createOrganization = (fields /*: Object */) => (dispatch /*: Function */) => {\n  const onFulfilled = (organization /*: Organization */) => {\n    dispatch(actions.createOrganization(organization));\n    dispatch(\n      addGlobalSuccessMessage(translateWithParameters('organization.created', organization.name))\n    );\n    return organization;\n  };\n\n  return api.createOrganization(fields).then(onFulfilled, onRejected(dispatch));\n};\n\nexport const updateOrganization = (key /*: string */, changes /*: {} */) => (\n  dispatch /*: Function */\n) => {\n  const onFulfilled = () => {\n    dispatch(actions.updateOrganization(key, changes));\n    dispatch(addGlobalSuccessMessage(translate('organization.updated')));\n  };\n\n  return api.updateOrganization(key, changes).then(onFulfilled, onFail(dispatch));\n};\n\nexport const deleteOrganization = (key /*: string */) => (dispatch /*: Function */) => {\n  const onFulfilled = () => {\n    dispatch(actions.deleteOrganization(key));\n    dispatch(addGlobalSuccessMessage(translate('organization.deleted')));\n  };\n\n  return api.deleteOrganization(key).then(onFulfilled, onFail(dispatch));\n};\n\nconst fetchMembers = (\n  dispatch /*: Function */,\n  receiveAction /*: Function */,\n  key /*: string */,\n  query /*: ?string */,\n  page /*: ?number */\n) => {\n  dispatch(membersActions.updateState(key, { loading: true }));\n  const data /*: Object */ = {\n    organization: key,\n    ps: PAGE_SIZE\n  };\n  if (page != null) {\n    data.p = page;\n  }\n  if (query) {\n    data.q = query;\n  }\n  return api.searchMembers(data).then(response => {\n    dispatch(\n      receiveAction(key, response.users, {\n        loading: false,\n        total: response.paging.total,\n        pageIndex: response.paging.pageIndex,\n        query: query || null\n      })\n    );\n  }, onMembersFail(key, dispatch));\n};\n\nexport const fetchOrganizationMembers = (key /*: string */, query /*: ?string */) => (\n  dispatch /*: Function */\n) => fetchMembers(dispatch, membersActions.receiveMembers, key, query);\n\nexport const fetchMoreOrganizationMembers = (key /*: string */, query /*: ?string */) => (\n  dispatch /*: Function */,\n  getState /*: Function */\n) =>\n  fetchMembers(\n    dispatch,\n    membersActions.receiveMoreMembers,\n    key,\n    query,\n    getOrganizationMembersState(getState(), key).pageIndex + 1\n  );\n\nexport const addOrganizationMember = (key /*: string */, member /*: Member */) => (\n  dispatch /*: Function */\n) => {\n  return api\n    .addMember({ login: member.login, organization: key })\n    .then(user => dispatch(membersActions.addMember(key, user)), onFail(dispatch));\n};\n\nexport const removeOrganizationMember = (key /*: string */, member /*: Member */) => (\n  dispatch /*: Function */\n) => {\n  dispatch(membersActions.removeMember(key, member));\n  return api.removeMember({ login: member.login, organization: key }).catch((\n    error /*: Object */\n  ) => {\n    onFail(dispatch)(error);\n    dispatch(membersActions.addMember(key, member));\n  });\n};\n\nexport const updateOrganizationMemberGroups = (\n  organization /*: Organization */,\n  member /*: Member */,\n  add /*: Array<string> */,\n  remove /*: Array<string> */\n) => (dispatch /*: Function */) => {\n  dispatch(\n    receiveUser({\n      ...member,\n      groupCount: (member.groupCount || 0) + add.length - remove.length\n    })\n  );\n  const promises = [\n    ...add.map(name =>\n      addUserToGroup({ name, login: member.login, organization: organization.key })\n    ),\n    ...remove.map(name =>\n      removeUserFromGroup({ name, login: member.login, organization: organization.key })\n    )\n  ];\n  return Promise.all(promises).catch(error => {\n    dispatch(receiveUser(member));\n    onFail(dispatch)(error);\n  });\n};\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport { getExtensionFromCache } from '../../utils/installExtensionsHandler';\n\nfunction installScript(key /*: string */) {\n  return new Promise(resolve => {\n    const scriptTag = document.createElement('script');\n    scriptTag.src = `${window.baseUrl}/static/${key}.js`;\n    scriptTag.onload = resolve;\n    document.getElementsByTagName('body')[0].appendChild(scriptTag);\n  });\n}\n\nexport function getExtensionStart(key /*: string */) {\n  return new Promise((resolve, reject) => {\n    const fromCache = getExtensionFromCache(key);\n    if (fromCache) {\n      return resolve(fromCache);\n    }\n\n    installScript(key).then(() => {\n      const start = getExtensionFromCache(key);\n      if (start) {\n        resolve(start);\n      } else {\n        reject();\n      }\n    });\n  });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport Helmet from 'react-helmet';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router';\nimport { injectIntl } from 'react-intl';\nimport { getExtensionStart } from './utils';\nimport { addGlobalErrorMessage } from '../../../store/globalMessages/duck';\nimport { getCurrentUser } from '../../../store/rootReducer';\nimport { translate } from '../../../helpers/l10n';\nimport getStore from '../../utils/getStore';\n\n/*::\ntype Props = {\n  currentUser: Object,\n  extension: {\n    key: string,\n    name: string\n  },\n  intl: Object,\n  location: { hash: string },\n  onFail: string => void,\n  options?: {},\n  router: Object\n};\n*/\n\nclass Extension extends React.PureComponent {\n  /*:: container: Object; */\n  /*:: props: Props; */\n  /*:: stop: ?Function; */\n\n  componentDidMount() {\n    this.startExtension();\n  }\n\n  componentDidUpdate(prevProps /*: Props */) {\n    if (prevProps.extension !== this.props.extension) {\n      this.stopExtension();\n      this.startExtension();\n    } else if (\n      prevProps.location !== this.props.location &&\n      // old router from backbone app updates hash, don't react in this case\n      prevProps.location.hash === this.props.location.hash\n    ) {\n      this.startExtension();\n    }\n  }\n\n  componentWillUnmount() {\n    this.stopExtension();\n  }\n\n  handleStart = (start /*: Function */) => {\n    const store = getStore();\n    this.stop = start({\n      store,\n      el: this.container,\n      currentUser: this.props.currentUser,\n      intl: this.props.intl,\n      location: this.props.location,\n      router: this.props.router,\n      ...this.props.options\n    });\n  };\n\n  handleFailure = () => {\n    this.props.onFail(translate('page_extension_failed'));\n  };\n\n  startExtension() {\n    const { extension } = this.props;\n    getExtensionStart(extension.key).then(this.handleStart, this.handleFailure);\n  }\n\n  stopExtension() {\n    if (this.stop) {\n      this.stop();\n      this.stop = null;\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <Helmet title={this.props.extension.name} />\n        <div ref={container => (this.container = container)} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(withRouter(Extension));\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { connect } from 'react-redux';\nimport Extension from './Extension';\nimport { getCurrentUser } from '../../../store/rootReducer';\nimport { addGlobalErrorMessage } from '../../../store/globalMessages/duck';\n\nconst mapStateToProps = (state: any) => ({\n  currentUser: getCurrentUser(state)\n});\n\nconst mapDispatchToProps = { onFail: addGlobalErrorMessage };\n\nexport default connect<any, any, any>(mapStateToProps, mapDispatchToProps)(Extension);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\n\nexport default function ExtensionNotFound() {\n  return (\n    <div id=\"bd\" className=\"page-wrapper-simple\">\n      <div id=\"nonav\" className=\"page-simple\">\n        <h2 className=\"big-spacer-bottom\">The page you were looking for does not exist.</h2>\n        <p className=\"spacer-bottom\">\n          You may have mistyped the address or the page may have moved.\n        </p>\n        <p>\n          <Link to=\"/\">Go back to the homepage</Link>\n        </p>\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}